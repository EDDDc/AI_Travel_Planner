services:
  server:
    build:
      context: ./server
      dockerfile: Dockerfile
      args:
        HTTP_PROXY: ${HTTP_PROXY}
        HTTPS_PROXY: ${HTTPS_PROXY}
        NO_PROXY: ${NO_PROXY}
    container_name: ai-travel-server
    environment:
      - BAILIAN_API_KEY=${BAILIAN_API_KEY}
      - XF_APP_ID=${XF_APP_ID}
      - XF_API_KEY=${XF_API_KEY}
      - XF_API_SECRET=${XF_API_SECRET}
      - AMAP_KEY=${AMAP_KEY}
      - HTTP_PROXY=${HTTP_PROXY}
      - HTTPS_PROXY=${HTTPS_PROXY}
      - NO_PROXY=${NO_PROXY}
    ports:
      - "8080:8080"

  web:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_SUPABASE_URL: ${VITE_SUPABASE_URL}
        VITE_SUPABASE_ANON_KEY: ${VITE_SUPABASE_ANON_KEY}
        VITE_AMAP_KEY: ${VITE_AMAP_KEY}
        VITE_AMAP_SECURITY_JSCODE: ${VITE_AMAP_SECURITY_JSCODE}
        HTTP_PROXY: ${HTTP_PROXY}
        HTTPS_PROXY: ${HTTPS_PROXY}
        NO_PROXY: ${NO_PROXY}
    container_name: ai-travel-web
    environment:
      - HTTP_PROXY=${HTTP_PROXY}
      - HTTPS_PROXY=${HTTPS_PROXY}
      - NO_PROXY=${NO_PROXY}
    ports:
      - "5173:80"
    depends_on:
      - server

